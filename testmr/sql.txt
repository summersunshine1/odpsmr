select t.id,t.word,t.count,t.risk,sum(t.count) as riskcount from ${t1} t group by t.risk;
select t.id,t.word,t.count,t.risk,t.riskcount, sum(t.count) as riskwordcount from ${t1} t group by t.risk,t.word;
select t.id,t.word,t.count,t.risk,t.riskcount,t.riskwordcount, sum(t.count) as totalcount from ${t1} t;
select t.id,t.word,t.count,t.risk,t.riskcount,t.riskwordcount, t.totalcount, count(distinct t.word) as totalwordcount from ${t1} t;
select t.id,t.word,t.count,t.risk,t.riskcount,t.riskwordcount, t.totalcount, t.totalwordcount from ${t1} t group by;

create table riskwordcount_table as select t.risk,t.word,sum(t.count) as riskwordcount from ${t1} t group by t.word,t.risk;
select * from riskwordcount_table;

create table riskcount_table as select t.risk,sum(t.riskwordcount) as riskcount,count(distinct t.word) as riskwordtotalcount from riskwordcount_table t group by t.risk;
select t.risk,t.word,t.riskwordcount,r.riskcount,r.riskwordtotalcount from riskwordcount_table t join riskcount_table r on t.risk=r.risk;

create table wordcount_table as select t.word, sum(t.riskwordcount) as wordcount from riskwordcount_table t group by t.word;
create table wordcount_table as select t.word, sum(t.riskwordcount) as wordcount from riskwordcount_table t group by t.word having  sum(t.riskwordcount)>500 ;
select t.risk,t.word,t.riskwordcount,t.riskcount,t.riskwordtotalcount,r.wordcount from ${t1} t join wordcount_table r on t.word = r.word;

create table filterword_table as select word from {$t1} t group by word having count(distinct t.risk)<=1
create table total_table as select t.risk,t.word,t.riskwordcount,t.riskcount,t.riskwordtotalcount,r.wordcount from ${t1} t join filterword_table r on t.word=r.word; 
select * from total_table;

select sum(t.riskwordcount) as totalcount,count(distinct t.word) as wordtotalcount from total_table t;

select risk,word from mutual_info_out where minfo>threshold and risk="sexy"
insert into table keywords select risk,word from mutual_info_out where minfo>threshold and risk="sexy"

select distinct word from keywords

create table total_table_out as select t.risk,t.word,t.riskwordcount,t.riskcount,t.riskwordtotalcount,t.wordcount,b.totalcount,b.wordtotalcount from total_table t full outer join ${t1} b;

alter table total_table add columns(totalcount bigint,wordtotalcount bigint);

drop table if exists total_table;
create table total_table as select t.risk,t.word,t.riskwordcount,t.riskcount,t.riskwordtotalcount,r.wordcount from ${t1} t join filterword_table r on t.word=r.word; 
select * from total_table;

create table filterword_table as select word,count(distinct risk) as uniquerisks from ${t1} t group by word having uniquerisks<=1;

COUNT(DISTINCT Location) AS UniqueLocations







